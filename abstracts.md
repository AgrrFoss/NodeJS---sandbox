# Конспект по курсу BackEnd
___
## Занятие от 10.04.2024. Начало работы с TS
### Первые 20-30 минут - настройка среды под линукс.
### Начало работы с TS - 19:05
* Установить  ts глобально
 sudo npm install -g typescript
глобально устанавливается компилятор tsc.
* создать файл с расширением .ts
* скомпилировать ts в js
* Запустить ```node hello.js```

Код в обратную сторону провернуть нельзя.
### Инициализация проекта на ТС 19:28
```tsc --init```
создастся файл tsconfig.json, после его создания не обязательно передавать все файлы параметрами команды tsc
достаточно казать их  в tsconfig.json, после чего командой ```tsc``` компилируется весь проект.

### Пакет ts-node - 19:40
позволяет выполнять тайпскрипт без предварительной компиляции
```sudo npm install -g ts-node``` - удобно для разработки.
```ts-node -v```
```ts-node filename.ts```

### Перевод 12го проекта на ts - 19:47

При компиляции произойдет перевод кода в commonJs это надо учитывать и возможно изменить настройки в package.json

### Декораторы - 2:30

___

## Занятие от 16.04. Запуск проекта на NESTjs
### Глобальная установка Nestjs Командой ```sudo npm i -g @nestjs/cli```
 
CLI - Command Line Interface - Командный интерфейс, который позволяет автоматизировать некоторые процедуры в проекте  

```nest --help``` - позволяет увидеть все команды.  

```nest new "project_name"``` - создаст дирректорию и в ней проект  
```nest new --directory ./ "project_name"``` - Создает проект в существующей директории с заданным именем
### Решение конфликта с Гитом  с 00:38:00
При попытке сделать первый коммит возникает кофликт, так как Nest создал свой гит реопзиторий.
###  Запуск проекта. 00:50:00
### Порядок действия для запуска проекта 1:19:00
### Подключение переменных окражуения 1:30
У nestjs есть модуль config, который позволяет получать пременные окружения  
Для этого потребуется модуль ```npm install @nestjs/config```
Добавляем внутрь функции bootstrap в main.ts  
>const configService = app.get(ConfigService);
### Подключение импортов в Nestjs 1:39-1:43
Чтобы модуль стал доступен нужно в app.module.ts импортировать ConfigModule
в imports [] сконфигурировать, передав метод ConfigModule.forRoot ({})
### 1:43 - 1:47 - Решение проблемы с ipv6
Для корректного отображения ip-адреса приложения необходимо задать второй параметр

>await app.listen(port, '0.0.0.0'); 
 
### 1:47 - 2:07 Описание струкруры проекта в Nestjs

### 2:07 Проверка проекта в Postman

### Добавление в проект своих путей запросов и ответов.
По умолчанию в заголовке ответа Нест отвечает строкой "Hello world" для изменения этого поведения небоходимо изменить код в разделе
> AppService.ts

По умолчанию Нест получает входящие данные на роутер "/", изменить это поведение можно в контроллерах, добавив
строку с необходимым адресом в app.Controller.ts
В декоратор контроллера базовый роут
в декоратор Get строка для get запроса.


```
import { Controller, Get } from '@nestjs/common';
import { AppService, ITestResponse } from './app.service';

@Controller('/api/v1.0')
export class AppController {
  constructor(private readonly appService: AppService) {}

  @Get('/contacts')
  getHello(): ITestResponse {
    return this.appService.getHello();
  }
}
```
Роут /api/ можно переопределить еще более глобально в main.ts 

### Переработка проекта с разделением на модули - 2:23.
Структура с изменениями в контроллер и сервис допустима только в случае, когда на весь 
проект 2-3 ендпоинта(роута), если роутов больше, необходимо разделение проекта на чатси.
Для этого используется CLI интерйфейс.

```
nest g res
```
после чего пишем имя ресурса, выбираем тип Rest Api, и подверждаем желание создания CRUD entry points
команда создает готовый круд модуль - дирректорию, содержащую:
* главный файл - модуль,
* Сервис с функциями обработки запроса
* Контроллер с энпоинтами и методами запроса
* entities - заготовка для взаимодействия с TypeOrm
* dto -  

### Изменение структуры проекта, удаление базового сервиса и контроллера - 2:37.
Для проектов с большим количеством ентрипоинтов можно из главного модуля удалить импорты:
* app.controller.ts
* app.service.ts


### Добавление статичных файлов фронтенда в проект - 2:43.

Выносим импорты в отдельные конфиги.
Добавляем модуль  `npm install @nestjs/serve-static`
ЧТобы сделать путь относительным потребуется метод **join** из node:path


___

## Занятие от 17.04. Подключение базы данных постгресс.
в каталоге Src:
```nest g res```
указываем сущность, которую хотим создать например "users"
ентер => yes
 создастся 5 файлов, нам нужны 3, без тестов

Модели БД лежат в папке entities, эти entities надо определить.

Реализуем подключение к БД. Для этого потребуется модуль TypeOrm

Выходим в каталог проекта, где лежит нода, там выполняем
```npm i @nestjs/typeorm typeorm pg```
в app.module.ts импортируем  typeorm и регистрируем его в импортах.

создаем:  __19:00 - 19: 10__
```
const ormConfig: TypeOrmModuleOptions = {
 type: "postgres",\
 host: configService.get('NODEAPP_HOST', 'localhost' ),\
 port: ...\
 ...\
 entities: [join(__dirname, '**', '*.entity{.ts,.js}')] //файлы js нужны так как после компиляции ts не будет.\
 synchronize: true - в продакшене выключается в false
}
```

### Запуск проекта в 19:22 - Выпадает в ошибку окружений.
Импортируем config  from 'dotenv'
выполняем config();

### Создание первых таблиц в БД - 19:27.
### Создание связей многих ко многим - 19:43
### Создание дампа БД
### Успешное создание дампа 20:12
